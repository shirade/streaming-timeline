<!DOCTYPE html><html lang="en"><head><title>Your Twitter Streaming Timeline</title><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"/><link rel="stylesheet" href="css/cover.css"/><script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script><script src="/socket.io/socket.io.js"></script></head><body><div class="site-wrapper"><div class="site-wrapper-inner"><div class="cover-container"><div class="masthead clearfix"><div class="inner"><h3 class="masthead-brand">Timeline Streaming</h3><ul class="nav masthead-nav"><li><a href="/logout">Logout</a></li></ul></div></div><script> (function () {
   var socket = io();

  socket.on('init', function (tweets) {
    var timeline = $('#timeline');
    for (var i = 0; i < tweets.length; i++) {
      var tweet = tweets[i];
      timeline.append(tweetUL(tweet));
    };
  });

  socket.on('new tweet', function (tweet) {
    $('#timeline .tweet:last').remove();
    $('#timeline').prepend(tweetUL(tweet));
  });

  socket.on('delete tweet', function (tweet) { 
    if ($('#timeline .tweet[data-uid=' + tweet.id + ']').remove().length == 1) {
      socket.emit('tweet');
    }
  });

  socket.on('supplemental tweet', function (tweet) {
    $('#timeline').append(tweetUL(tweet));
  });

  socket.on('redirect index', function () {
    location.href='/';
  });

  window.onload = function () {
    socket.emit('init');
  };;
  window.onunload = function () {
    socket.emit('unconnect');
  };
 })();
  function tweetUL (tweet) {
  var ul = '';
  ul += '<ul class="tweet" data-uid=' + tweet.id + '>';
  ul += '<div class="image_frame">';
  ul += '<div class="image"><img src="' + tweet.user.profile_image_url + '" alt="' + tweet.user.screen_name + '" style="border-radius: 7px;"></div>';
  ul += '</div>';
  ul += '<div class="user">' + tweet.user.name + ' @' + tweet.user.screen_name + '</div>';  
  ul += '<div class="text">' + tweet.text + '</div>';
  //ul += '<div class="delete"><a href="delete">delete(do not push)</a></div>';
  ul += '</ul>';
  return ul;
}
module.exports.tweetUL = tweetUL;</script><div class="inner cover"><ul id="timeline"></ul></div><div class="mastfoot"><div class="inner"><p>Copyright &copy; 2014 ○○○○○○○○○ All Rights Reserved.</p></div></div></div></div></div></body></html>